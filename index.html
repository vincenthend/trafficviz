<html>
    <head>
    	<link rel="stylesheet" type="text/css" href="css/slider.css" />
        <title>Bandung's Traffic Accidents</title>
        <script src="./js/d3.v5.min.js"></script>
        <script type="text/javascript" src="./js/Chart.min.js"></script>
        <script type="text/javascript" src="./js/rainbowvis.js"></script>
        <script type="text/javascript" src="./js/chart.js"></script>
        <script type="text/javascript" src="./js/slider.js"></script>
        <script type="text/javascript" src="./data.json"></script>
    </head>
    <body class="bg-viz">
    	<canvas id="bar-chart"></canvas>
		<div class="slider-container">
			<p id="time-label" class="slider-label">00:00-01:00</p>
			<img id="time-clock" src="assets/dial.svg" class="slider-clock">
			<input id="time-slider" type="range" min="0" max="23" value="0" step="1" class="slider" oninput="update()">
		</div>
    </body>
    <script>
		load();

		//Zoom
		function load(){
			d3.xml('./assets/map.svg').then(data => {
				document.body.append(data.documentElement);
				var svg = d3.select('svg');
				svg.attr("width","100%")
					.attr("height","100%")

				// Zoom
				svg.call(d3.zoom().scaleExtent([0.5,4.5])
					.on("zoom", function () {
					svg.select("#Map").attr("transform", d3.event.transform);
					})
				)
				
				svg.selectAll("g #DataLine path")
					.on("mouseover", mouseOver)
					.on("mouseout", mouseOut)
			});
		}
		
		function mouseOver(d, i){
			console.log("In");
			console.log(d);
			console.log(i);
		}
		
		function mouseOut(d, i){
			console.log("Out");
			console.log(d);
			console.log(i);
		}

		function loadJson(callback) {   
		    var xobj = new XMLHttpRequest();
		        xobj.overrideMimeType("application/json");
		    xobj.open('GET', 'data.json', true); // Replace 'my_data' with the path to your file
		    xobj.onreadystatechange = function () {
		          if (xobj.readyState == 4 && xobj.status == "200") {
		            // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
		            callback(xobj.responseText);
		          }
		    };
		    xobj.send(null);
	 	}
	 	function getAccidentData(jsonData, startTime, callback) {
 			var dataAtCurrentTime = [];

			for(i = 0; i < jsonData.length; i++) {
				if(jsonData[i].hour == startTime) {
					dataAtCurrentTime.push(jsonData[i]);
				}
			}
			callback(dataAtCurrentTime);
	 	}

    </script>
</html>